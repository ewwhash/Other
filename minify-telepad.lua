whiteList={"ewwhash","Chesh1r3","NemoCrazy87","hohserg"}symbol="?"side=3;bufferSide=3;ejectSide=1;version="selector"local function a(b)return component.proxy(component.list(b)())end;local c,d,e,f,g=a("inventory_controller"),a("robot"),a("redstone"),a("chat"),a("tractor_beam")local h=d.inventorySize()local i,j,k,l={},1,0;local function m(n,o)return n.label<o.label end;local function p(q)local r=computer.uptime()+q;repeat computer.pullSignal(r-computer.uptime())until computer.uptime()>=r end;local function s(t,u)d.select(u)f.say("§7Выкидываю мусор: '§a"..t.."§7'...")d.drop(0)d.select(1)end;local function v(u,w)local x=c.getStackInInternalSlot(u)if x then if x.name=="EnderIO:itemCoordSelector"or x.name=="enderio:item_location_printout"then local y=#i+1;i[y]={label=x.label,slot=u}i[y].title="§f'§a"..x.label.."§f'"i[y].page=j;k=k+1;if k==8 then j,k=j+1,0 end;table.sort(i,m)if w then f.say("§7Обнаружена новая точка '§a"..x.label.."§7'!")end else s(x.label,u)end end end;local function z()i={}local A,counter=1,0;for u=1,h do v(u)end;f.say("Сканирование завершено. Точек найдено: "..#i)end;local function B()f.say("§7Телепорт на точку: §c?tp §bточка§7.")f.say("§7Список точек: §c?list §bстраница§7.")f.say("§7Извлечь точку: §c?eject §bточка§7.")f.say("§7Добавление точки: §c?addpoint§7.")f.say("§7Обновление точек: §c?update§7.")end;local function C()e.setOutput(side,15)p(.1)e.setOutput(side,0)end;local function D(y)f.say("§7Подготовка к телепортации на '§a"..i[y].label.."§7'...")d.select(i[y].slot)if version=="selector"then c.equip()d.use(side,true)C()c.equip()elseif version=="paper"then d.drop(side)C()counter=0;while true do local x=c.getStackInSlot(bufferSide,1)counter=counter+1;if x and x.name=="enderio:item_location_printout"then d.suck(bufferSide)break end;if counter==500 then f.say("§cНе могу достать распечатку!")counter=0 end;p(0)end end;d.select(1)end;local function E(t)local F=false;local G=unicode.len(t)for y=1,#i do if unicode.sub(unicode.lower(i[y].label),1,G)==t then F=y;break end end;if F then return F else f.say("§cТочки "..t.." не существует!")end end;local function H(t)if t then t=unicode.lower(t)local y=E(t)if y then l=t;D(y)else B()end elseif l then D(l)else B()end end;local function I()if g.suck()then local J,u=computer.pullSignal(.3)if J=="inventory_changed"then v(u,true)end end end;local function K(t)if t then local y=E(unicode.lower(t))if y then f.say("§7Извлечение точки '§a"..i[y].label.."§7'...")d.select(i[y].slot)d.drop(ejectSide)d.select(1)table.remove(i,y)end else B()end end;local function L(A)if A then A=tonumber(A)if not A then B()else A=math.floor(A)end else A=1 end;if A then if A>j then f.say("§cВсего "..j.." страниц.")else f.say("§6§lТочки - Страница "..A.."/"..j)for y=1,#i do if i[y].page==A then f.say(i[y].title)end end end end end;local M={help=B,tp=H,list=L,update=z,addpoint=I,eject=K}for N=1,#whiteList do whiteList[whiteList[N]],whiteList[N]=true,nil end;d.select(1)f.setName("§eTelepad§7§o")z()while true do local O={computer.pullSignal()}if O[1]=="chat_message"and whiteList[O[3]]then f.setName("§eTelepad§7§o")if O[4]:sub(1,1)==symbol then local P=O[4]:sub(2,#O[4])local Q={}for R in P:gsub("^(.-)%s*$","%1"):gmatch("%s*([^%s]+)")do Q[#Q+1]="%q":format(R):gsub('"','')end;if M[Q[1]]then M[Q[1]](table.unpack(Q,2,#Q))else B()end end end end
